<div class="container">
  <div class="row">
    <div class="col-md-9">
      <h4>Shopping Cart</h4>
      <table class="table">
        <thead class="blue-grey lighten-4">
          <tr>
            <th>image</th>
            <th>name</th>
            <th>unit price</th>
            <th>qty</th>
            <th>cost</th>
            <th>remove</th>
          </tr>
        </thead>
        <tbody *ngFor="let cartItem of this.cartService.cart; let i = index">
          <tr>
            <td><img src={{cartItem.imagelink}} /></td>
            <td>{{cartItem.name}}</td>
            <td>{{cartItem.price}}</td>
            <td><input (change)="this.cartService.getSubTotal()" type="number" [(ngModel)]="cartItem.qty" class="qty" /></td>
            <td>{{(cartItem.price * cartItem.qty).toFixed(2)}}</td>
            <td><button (click)="removeItem(i); this.cartService.getSubTotal()" class="btn btn-danger btn-sm">x</button></td>
          </tr>

        </tbody>
      </table>
    </div>
    <div class="col-md-3">
      <h4>Enter shipping details</h4>
      <form (ngSubmit)="processOrder()" [formGroup]="checkoutForm" novalidate class="checkout">
        <div class="form-group" [ngClass]="{
          'has-danger': name.invalid && name.dirty, 
          'has-success': name.valid && name.dirty 
        }">
          <input type="text" class="form-control" placeholder="Enter name" formControlName="name" required>
          <div class="form-control-feedback" *ngIf="name.errors && (name.dirty || name.touched)">
            <p *ngIf="name.errors.required">name is required</p>
            <p *ngIf="name.errors.minlength">name must be 4 or more characters long</p>
          </div>
        </div>
      
        <div class="form-group" [ngClass]="{
          'has-danger': address.invalid && address.dirty, 
          'has-success': address.valid && address.dirty 
        }">
          <input type="text" class="form-control" placeholder="Enter address" formControlName="address" required>
          <div class="form-control-feedback" *ngIf="address.errors && (address.dirty || address.touched)">
            <p *ngIf="address.errors.required">address is required</p>
          </div>
      </div>
      
      <div class="form-group" [ngClass]="{
          'has-danger': city.invalid && city.dirty, 
          'has-success': city.valid && city.dirty 
        }">
        <input type="text" class="form-control" placeholder="Enter city" formControlName="city" required>
          <div class="form-control-feedback" *ngIf="city.errors && (city.dirty || city.touched)">
            <p *ngIf="city.errors.required">city is required</p>
          </div>
      </div>
      
      <div class="form-group" [ngClass]="{
          'has-danger': phone.invalid && phone.dirty, 
          'has-success': phone.valid && phone.dirty 
        }">
        <input type="text" class="form-control" placeholder="Enter phone" formControlName="phone" required>
        <div class="form-control-feedback" *ngIf="phone.errors && (phone.dirty || phone.touched)">
          <p *ngIf="phone.errors.required">phone is required</p>
        </div>
      </div>
      <h5>Subtotal: ${{this.cartService.subTotal.toFixed(2)}}</h5>
      <h5>Shipping: ${{shipping.toFixed(2)}}</h5>
      <h5>Tax(10%): ${{(this.cartService.subTotal * 0.1).toFixed(2)}}</h5>
      <h5><b>Total: ${{(this.cartService.subTotal + (this.cartService.subTotal * 0.1) + 10).toFixed(2)}}</b></h5>
      
      <button type="submit" class="btn btn-primary">Submit</button>
      </form>
    </div>

  </div>
</div>